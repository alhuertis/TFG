<cabecera-profesor></cabecera-profesor>

<div class="panel-profesor container-fluid">
    
    <div class="row">
        <div class="col-md-3 col-sm-3 menu-profesor-arbol">
            <ul id="tree1">
                <li class="rama-ejercicios"> Ejercicios <span class="badge badge-small"> {{nEjercicios}}</span><i *ngIf="nEjercicios" (click)="seleccionaDatos('ejercicios', 'ejercicios')" class="glyphicon glyphicon-eye-open ojo"></i>

                    <ul>
                      <li> Mi Coleccion <span class="badge badge-small"> {{nMiColeccion}}</span><i *ngIf="nMiColeccion" (click)="seleccionaDatos('mios', 'ejercicios')" class="glyphicon glyphicon-eye-open ojo"></i>
                        <ul>
                          <li><a href="#"> Nivel</a>
                            <ul>
                              <li> Bajo <span class="badge badge-small">{{nMiColeccionNivelB}}</span><i *ngIf="nMiColeccionNivelB" (click)="seleccionaDatos('mios bajo', 'ejercicios')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                              <li> Medio <span class="badge badge-small">{{nMiColeccionNivelM}}</span><i *ngIf="nMiColeccionNivelM" (click)="seleccionaDatos('mios medio', 'ejercicios')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                              <li> Avanzado <span class="badge badge-small">{{nMiColeccionNivelA}}</span><i *ngIf="nMiColeccionNivelA" (click)="seleccionaDatos('mios avanzado', 'ejercicios')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                            </ul>
                          </li>
                          <li> Tipo
                            <ul>
                              <li> Tipo 1 <span class="badge badge-small">{{nMiColeccionTipo1}}</span><i *ngIf="nMiColeccionTipo1" (click)="seleccionaDatos('mios T1', 'ejercicios')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                              <li> Tipo 2 <span class="badge badge-small">{{nMiColeccionTipo2}}</span><i *ngIf="nMiColeccionTipo2" (click)="seleccionaDatos('mios T2', 'ejercicios')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                              <li> Tipo 3 <span class="badge badge-small">{{nMiColeccionTipo3}}</span><i *ngIf="nMiColeccionTipo3" (click)="seleccionaDatos('mios T3', 'ejercicios')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                              <li> Tipo 4 <span class="badge badge-small">{{nMiColeccionTipo4}}</span><i *ngIf="nMiColeccionTipo4" (click)="seleccionaDatos('mios T4', 'ejercicios')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                            </ul>
                          </li> 
                          </ul>
                        </li>
                        <li> Otras Colecciones <span class="badge badge-small"> {{nEjercicios-nMiColeccion}}</span><i *ngIf="nEjercicios-nMiColeccion" (click)="seleccionaDatos('otros', 'ejercicios')" class="glyphicon glyphicon-eye-open ojo"></i>
                        <ul>
                          <li> Nivel
                            <ul>
                              <li> Bajo <span class="badge badge-small">{{nOtrasColeccionesNivelB}}</span><i *ngIf="nOtrasColeccionesNivelB" (click)="seleccionaDatos('otros bajo', 'ejercicios')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                              <li> Medio <span class="badge badge-small">{{nOtrasColeccionesNivelM}}</span><i *ngIf="nOtrasColeccionesNivelM" (click)="seleccionaDatos('otros medio', 'ejercicios')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                              <li> Avanzado <span class="badge badge-small">{{nOtrasColeccionesNivelA}}</span><i *ngIf="nOtrasColeccionesNivelA" (click)="seleccionaDatos('otros avanzado', 'ejercicios')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                            </ul>
                          </li>
                          <li> Tipo
                            <ul>
                              <li> Tipo 1 <span class="badge badge-small">{{nOtrasColeccionesTipo1}}</span><i *ngIf="nOtrasColeccionesTipo1" (click)="seleccionaDatos('otros T1', 'ejercicios')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                              <li> Tipo 2 <span class="badge badge-small">{{nOtrasColeccionesTipo2}}</span><i *ngIf="nOtrasColeccionesTipo2" (click)="seleccionaDatos('otros T2', 'ejercicios')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                              <li> Tipo 3 <span class="badge badge-small">{{nOtrasColeccionesTipo3}}</span><i *ngIf="nOtrasColeccionesTipo3" (click)="seleccionaDatos('otros T3', 'ejercicios')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                              <li> Tipo 4 <span class="badge badge-small">{{nOtrasColeccionesTipo4}}</span><i *ngIf="nOtrasColeccionesTipo4" (click)="seleccionaDatos('otros T4', 'ejercicios')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                            </ul>
                          </li> 
                          </ul>
                        </li>
                    </ul>
                </li>
                

                <li class="rama-actividades"> Actividades <span class="badge badge-small"> {{miColeccionAct.length}}</span><i *ngIf="miColeccionAct.length" (click)="seleccionaDatos('mias', 'actividades')" class="glyphicon glyphicon-eye-open ojo"></i> 
                  <ul>
                    <li> Nivel
                      <ul>
                        <li> Bajo <span class="badge badge-small"> {{miColeccionNivelBAct.length}}</span><i *ngIf="miColeccionNivelBAct.length" (click)="seleccionaDatos('mias bajas', 'actividades')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                        <li> Medio <span class="badge badge-small"> {{miColeccionNivelMAct.length}}</span><i *ngIf="miColeccionNivelMAct.length" (click)="seleccionaDatos('mias medias', 'actividades')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                        <li> Avanzado <span class="badge badge-small"> {{miColeccionNivelAAct.length}}</span><i *ngIf="miColeccionNivelAAct.length" (click)="seleccionaDatos('mias avanzadas', 'actividades')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                      </ul>
                    </li>
                    <li> Actividades visibles <span class="badge badge-small"> {{visibles.length}}</span><i *ngIf="visibles.length" (click)="seleccionaDatos('visibles', 'actividades')" class="glyphicon glyphicon-eye-open ojo"></i>
                      <ul>
                        <li> Nivel
                          <ul>
                            <li> Bajo <span class="badge badge-small"> {{visiblesNivelBAct.length}}</span><i *ngIf="visiblesNivelBAct.length" (click)="seleccionaDatos('visibles bajas', 'actividades')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                            <li> Medio <span class="badge badge-small"> {{visiblesNivelBAct.length}}</span><i *ngIf="visiblesNivelBAct.length" (click)="seleccionaDatos('visibles medias', 'actividades')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                            <li> Avanzado <span class="badge badge-small"> {{visiblesNivelBAct.length}}</span><i *ngIf="visiblesNivelBAct.length" (click)="seleccionaDatos('visibles avanzadas', 'actividades')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                          </ul>
                        </li>
                      </ul>
                    </li>
                    <li> Actividades no visibles <span class="badge badge-small"> {{invisibles.length}}</span><i *ngIf="invisibles.length" (click)="seleccionaDatos('invisibles', 'actividades')" class="glyphicon glyphicon-eye-open ojo"></i>
                      <ul>
                        <li> Nivel
                          <ul>
                            <li> Bajo <span class="badge badge-small"> {{invisiblesNivelBAct.length}}</span><i *ngIf="invisiblesNivelBAct.length" (click)="seleccionaDatos('invisibles bajas', 'actividades')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                            <li> Medio <span class="badge badge-small"> {{invisiblesNivelBAct.length}}</span><i *ngIf="invisiblesNivelBAct.length" (click)="seleccionaDatos('invisibles medias', 'actividades')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                            <li> Avanzado <span class="badge badge-small"> {{invisiblesNivelBAct.length}}</span><i *ngIf="invisiblesNivelBAct.length" (click)="seleccionaDatos('invisibles avanzadas', 'actividades')" class="glyphicon glyphicon-eye-open ojo"></i></li>
                          </ul>
                        </li>
                      </ul>
                    </li> 
                    </ul>
                </li>
            </ul>                
        </div>
 
        <div class="col-md-5 col-sm-5 panel-ejercicios">
          <div class="row">
            <div class="col-sm-12">
              <h3 class="text-center" *ngIf="mostrarListaEjers || mostrarListaActs ">{{datosAMostrar}}</h3>
            </div>
          </div>
          
          <div class="row" *ngIf="mostrarListaEjers">
         
              <div class="col-md-12 ejer-lista animated fadeInLeft" *ngFor="let ejercicio of pagedItemsEjers; let i=index">
                <div class="row">
                  <div class="col-sm-1">
                      <input type="checkbox" [checked]="ejercicio.marcado" (click)="addActividad($event, ejercicio._id)">
                  </div>
                  <div class="col-sm-9">
                    <div class="row">
                      <div class="col-md-6">
                        <ul>
                          <li><i class="glyphicon glyphicon-pencil"></i> {{ejercicio.titulo | truncate:35}}</li>
                          <li><i class="glyphicon glyphicon-user"></i> {{ejercicio.autor}}</li>     
                        </ul>
                      </div>
                    
                    <div class="col-md-6">
                      <ul>
                        <li><i class="glyphicon glyphicon-tags"></i> {{ejercicio.tipo}}</li>
                        <li><i class="glyphicon glyphicon-signal"></i> {{ejercicio.nivel}}</li>
                      </ul>
                    </div>
                  </div>
                  </div>

                  <div class="col-sm-2 botones-lista">
                      <i class="glyphicon glyphicon-info-sign" id="info-ejer" (click)="showEjercicio(ejercicio)"></i>
                      <i class="glyphicon glyphicon-cog" id="modificar-ejer" (click)="abrirModEjercicio(ejercicio)"></i>
                      <i class="glyphicon glyphicon-trash" id="borrar-ejer" (click)="abrirBorrarEjercicio(ejercicio)"></i>
                  </div>
                </div>
              </div>
            
          </div>

          <div class="row" *ngIf="mostrarListaActs">
         
              <div class="col-md-12 act-lista animated fadeInLeft" *ngFor="let actividad of pagedItemsActs; let i=index">
                <div class="row">
                  <div class="col-sm-1">
                      <input type="checkbox" [checked]="actividad.marcado">
                  </div>
                  <div class="col-sm-9">
                    <div class="row">
                      <div class="col-md-6">
                        <ul>
                          <li><i class="glyphicon glyphicon-pencil"></i> {{actividad.titulo | truncate : 25}}</li>
                          <li><i class="glyphicon glyphicon-user"></i> {{actividad.profesor}}</li>     
                        </ul>
                      </div>
                    
                    <div class="col-md-6">
                      <ul>
                        <li><i class="glyphicon glyphicon-calendar"></i> {{actividad.fecha_creacion | date : 'dd/mm/yyyy'}}</li>
                        <li><i class="glyphicon glyphicon-signal"></i> {{actividad.nivel}}</li>
                      </ul>
                    </div>
                  </div>
                  </div>

                  <div class="col-sm-2 botones-lista">
                      <i class="glyphicon glyphicon-info-sign" id="info-act" (click)="showEjercicio(ejercicio)"></i>
                      <i class="glyphicon glyphicon-cog" id="modificar-act" (click)="showEjercicio(ejercicio)"></i>
                      <i class="glyphicon glyphicon-trash" id="borrar-act" (click)="abrirBorrarEjercicio(ejercicio)"></i>
                  </div>
                </div>
              </div>
            
          </div>

          <div class="row">
            <div class="col-sm-12">
              <!-- pager -->
              <ul *ngIf="pager.pages && pager.pages.length" class="pagination">
                <li [ngClass]="{disabled:pager.currentPage === 1}">
                  <a (click)="setPage(1)">First</a>
                </li>
                <li [ngClass]="{disabled:pager.currentPage === 1}">
                  <a (click)="setPage(pager.currentPage - 1)">Previous</a>
                </li>
                <li *ngFor="let page of pager.pages" [ngClass]="{active:pager.currentPage === page}">
                  <a (click)="setPage(page)">{{page}}</a>
                </li>
                <li [ngClass]="{disabled:pager.currentPage === pager.totalPages}">
                  <a (click)="setPage(pager.currentPage + 1)">Next</a>
                </li>
                <li [ngClass]="{disabled:pager.currentPage === pager.totalPages}">
                  <a (click)="setPage(pager.totalPages)">Last</a>
                </li>
              </ul>
            </div>
          </div>
        </div>
        

        <div class="col-md-4 col-sm-4 panel-actividad" *ngIf="mostrarListaEjers || mostrarListaActs">
          <div class="row">
            <div class="col-md-12">
              <h4 class="text-center">Seleccion para actividad</h4>
            </div>
          </div>

          <div class="row"> 
            <div class="col-md-12 listado-actividad">
              <ul>
                <li *ngFor="let ejer of actividad" class="animated fadeInLeft">
                  <i class="glyphicon glyphicon-pencil"></i> <span>{{ejer.titulo | truncate : 5}}</span>
                  <i class="glyphicon glyphicon-tags"></i> <span>{{ejer.tipo}}</span>
                  <i class="glyphicon glyphicon-signal"></i> <span id="last">{{ejer.nivel}}</span>
                  <i class="glyphicon glyphicon-remove" (click)="descartarEjer($event, ejer._id)"></i>
                </li>
              </ul>
              <div class="opciones-actividad">
                <a (click)="vaciarLista()">Vaciar lista</a>
                <a (click)="crearActividad()">Crear</a>
              </div>
            </div>
          </div>
        </div>
   

  </div>

  <!-- modal mostrar ejercicio -->
  <div style="background: rgba(63,63,61,0.8);" (click)="hideEjercicio()" class="modal fade" tabindex="-1" [ngClass]="{'in': visibleAnimate}"
        [ngStyle]="{'display': modalEjercicio ? 'block' : 'none', 'opacity': visibleAnimate ? 1 : 0}">
    <div class="modal-dialog">
      <div class="modal-content">
        <div *ngIf="ejerAbrir != null" class="modal-header">
          Titulo: {{ejerAbrir.titulo}}
        </div>
        <div *ngIf="ejerAbrir != null" class="modal-body">
          <p>Autor: {{ejerAbrir.autor}}</p>
          <p>Nivel: {{ejerAbrir.nivel}}</p>
          <p>Tipo: {{ejerAbrir.tipo}}</p>
          <p>Enunciado: {{ejerAbrir.enunciado}}</p>
          <p>Frase a traducir: {{ejerAbrir.fraseATraducir}}</p>

        </div>
        <div class="modal-footer">
        </div>
      </div>
    </div>
  </div>

  <!-- modal crear actividad -->
  <div style="background: rgba(63,63,61,0.8);" class="modal fade" tabindex="-1" [ngClass]="{'in': visibleAnimate}"
        [ngStyle]="{'display': modalActividad ? 'block' : 'none', 'opacity': visibleAnimate ? 1 : 0}">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h4>Completar datos de la actividad</h4>
          </div>
          <div class="modal-body">
            <div class="form-nueva-actividad" *ngIf="nuevaActividad != null">
              <input type="text" class="form-control"  placeholder="Titulo de actividad" name="titulo" #titulo="ngModel" [(ngModel)]="nuevaActividad.titulo">
              <label for="power">Nivel</label>
              <select class="form-control" name="nivel" #nivel="ngModel" 
                  required
                  [(ngModel)]="nuevaActividad.nivel">
                <option value="Bajo">Bajo</option>
                <option value="Medio">Medio</option>
                <option value="Avanzado">Avanzado</option>
              </select>

              <div>
                <label>
                  <input #visible [(ngModel)]="nuevaActividad.visible" type="checkbox" data-toggle="toggle">Visible
                </label>
              </div>
             

              <div>
                <label>
                <input #propuesta [(ngModel)]="nuevaActividad.propuesta" type="checkbox" data-toggle="toggle">Propuesta
              </label>
              </div>
              
              <div [ngStyle]="{'display': nuevaActividad.propuesta ? 'block' : 'none'}">
                <label for="">Fecha de fin </label>
                <input type="date" name="fecha-fin" [(ngModel)]="nuevaActividad.fecha_prop_fin" useValueAsDate>
              </div>
              

            </div>
            
          </div>
          <div class="modal-footer">
            <button (click)="cancelarActividad()" class="btn">Cancelar</button>
            <button (click)="guardarActividad()" class="btn btn-success">Guardar</button>
          </div>
        </div>
      </div>
  </div>


  <!-- modal borrar ejercicio -->
  <div style="background: rgba(63,63,61,0.8);" class="modal fade" tabindex="-1" [ngClass]="{'in': visibleAnimate}"
        [ngStyle]="{'display': modalBorrarEjercicio ? 'block' : 'none', 'opacity': visibleAnimate ? 1 : 0}">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h4><i class="glyphicon glyphicon-trash"></i>Borrar ejercicio</h4>
        </div>
        <div class="modal-body">
          <p>¿Estás seguro que desea borrar este ejercicio?</p>
        </div>
        <div class="modal-footer">
          <button class="btn btn-success" (click)="borrarEjercicio()">Aceptar</button>
          <button class="btn btn-danger" (click)="cerrarBorrarEjercicio()">Cancelar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- modal modificar ejercicio -->
  <div style="background: rgba(63,63,61,0.8);" class="modal fade" tabindex="-1" [ngClass]="{'in': visibleAnimate}"
        [ngStyle]="{'display': modalModEjer ? 'block' : 'none', 'opacity': visibleAnimate ? 1 : 0}">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h4><i class="glyphicon glyphicon-cog"></i> Modificar ejercicio: {{ejerUpdate.titulo}}</h4>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-md-4">
              <label for="titulo">Titulo</label>
              <input type="text" class="form-control"  placeholder="Titulo..." name="titulo" #titulo="ngModel" [(ngModel)]="ejerUpdate.titulo">

            </div>

          </div>
          
        </div>
        <div class="modal-footer">
          <button class="btn btn-success" (click)="updateEjercicio()">Aceptar</button>
          <button class="btn btn-danger" (click)="cerrarUpdateEjercicio()">Cancelar</button>
        </div>
      </div>
    </div>
  </div>

</div>



		

